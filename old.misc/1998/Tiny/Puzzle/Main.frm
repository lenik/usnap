VERSION 5.00
Begin VB.Form frmMain
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "拼板游戏"
   ClientHeight    =   1875
   ClientLeft      =   3195
   ClientTop       =   4080
   ClientWidth     =   2550
   Icon            =   "Main.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   1875
   ScaleWidth      =   2550
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   24
      Left            =   1740
      TabIndex        =   24
      TabStop         =   0   'False
      Top             =   1380
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   23
      Left            =   1440
      TabIndex        =   23
      TabStop         =   0   'False
      Top             =   1380
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   22
      Left            =   1140
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   1380
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   21
      Left            =   840
      TabIndex        =   21
      TabStop         =   0   'False
      Top             =   1380
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   20
      Left            =   540
      TabIndex        =   20
      TabStop         =   0   'False
      Top             =   1380
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   19
      Left            =   1740
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   1080
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   18
      Left            =   1440
      TabIndex        =   18
      TabStop         =   0   'False
      Top             =   1080
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   17
      Left            =   1140
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   1080
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   16
      Left            =   840
      TabIndex        =   16
      TabStop         =   0   'False
      Top             =   1080
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   15
      Left            =   540
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   1080
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   14
      Left            =   1740
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   780
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   13
      Left            =   1440
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   780
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   12
      Left            =   1140
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   780
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   11
      Left            =   840
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   780
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   10
      Left            =   540
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   780
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   9
      Left            =   1740
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   480
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   8
      Left            =   1440
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   480
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   7
      Left            =   1140
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   480
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   6
      Left            =   840
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   480
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   5
      Left            =   540
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   480
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   4
      Left            =   1740
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   180
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   3
      Left            =   1440
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   180
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   2
      Left            =   1140
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   180
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   1
      Left            =   840
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   180
      Width           =   255
   End
   Begin VB.CommandButton cmdButton
      Caption         =   "A"
      Height          =   255
      Index           =   0
      Left            =   540
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   180
      Width           =   255
   End
   Begin VB.Menu mnuNew
      Caption         =   "&G新游戏"
   End
   Begin VB.Menu mnuAbout
      Caption         =   "&A关于"
   End
   Begin VB.Menu mnuExit
      Caption         =   "&X退出"
   End
End
Attribute VB_Name = "frmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim genedata As Boolean

Private Sub cmdButton_Click(Index As Integer)
  If cmdButton(Index).Caption = "" Then Exit Sub
  If Index Mod 5 > 0 Then   'is left space
    If cmdButton(Index - 1).Caption = "" Then
      cmdButton(Index - 1).Caption = cmdButton(Index).Caption
      cmdButton(Index).Caption = ""
    End If
  End If
  If (Index + 1) Mod 5 > 0 Then 'is right space
    If cmdButton(Index + 1).Caption = "" Then
      cmdButton(Index + 1).Caption = cmdButton(Index).Caption
      cmdButton(Index).Caption = ""
    End If
  End If
  If Index > 4 Then
    If cmdButton(Index - 5).Caption = "" Then
      cmdButton(Index - 5).Caption = cmdButton(Index).Caption
      cmdButton(Index).Caption = ""
    End If
  End If
  If Index < 20 Then
    If cmdButton(Index + 5).Caption = "" Then
      cmdButton(Index + 5).Caption = cmdButton(Index).Caption
      cmdButton(Index).Caption = ""
    End If
  End If
  If genedata = True Then Exit Sub 'no any needs.
  For ci = 1 To 23
    If cmdButton(ci).Caption <> "" And cmdButton(ci - 1).Caption <> "" Then
      If Asc(cmdButton(ci).Caption) <> Asc(cmdButton(ci - 1).Caption) + 1 Then Exit Sub
    End If
  Next
  frmSuccess.Show 1
  cont = MsgBox("祝贺你成功!" + Chr(13) + Chr(10) + "再来一盘么?", vbYesNo, "好棒耶!")
  If cont = vbNo Then End
  mnuNew_Click
End Sub

Private Sub cmdButton_KeyPress(Index As Integer, KeyAscii As Integer)
  Select Case Chr(KeyAscii)
    Case "8":
      If Index > 4 Then
        cmdButton(Index - 5).SetFocus
      End If
    Case "2":
      If Index < 20 Then
        cmdButton(Index + 5).SetFocus
      End If
    Case "4":
      If Index > 0 Then
        cmdButton(Index - 1).SetFocus
      End If
    Case "6":
      If Index < 24 Then
        cmdButton(Index + 1).SetFocus
      End If
    Case "!":
      For se = 0 To 24
        If cmdButton(se).Caption = "" Then
          cmdButton(se).Caption = cmdButton(Index).Caption
          cmdButton(Index).Caption = ""
          Exit For
        End If
      Next
    Case Else
      For se = 0 To 24
        If LCase(cmdButton(se).Caption) = LCase(Chr(KeyAscii)) Then
          cmdButton_Click Int(se)
          Exit For
        End If
      Next
  End Select
End Sub

Private Sub Form_Load()
  For i = 0 To 24
    cmdButton(i).Caption = Chr$(Asc("A") + i)
  Next
  cmdButton(24).Caption = ""
  mnuNew_Click
End Sub

Private Sub mnuAbout_Click()
  frmAbout.Show
End Sub

Private Sub mnuExit_Click()
  End
End Sub

Private Sub mnuNew_Click()
  genedata = True
  For i = 0 To 1000
    cmdButton_Click (Int(Rnd * 25))
  Next
  genedata = False
End Sub
